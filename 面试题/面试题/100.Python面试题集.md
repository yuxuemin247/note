## Python面试题

1. 说一说Python中的新式类和旧式类有什么区别。

   答：python2中默认都是旧式类，只有显示继承了object才是新式类

   ​		python3中默认都是新式类，不必显示的继承object

   ​		新式类的MRO(method resolution  方法解析顺序) 采用的广度优先，而旧式类的MRO算法采用的是深度优先

3. Python中如何动态设置和获取对象属性？

   答：`setattr(object, name, value)`和`getattr(object, name[, default])`内置函数，其中`object`是对象，`name`是对象的属性名，`value`是属性值。这两个函数会调用对象的`__getattr__`和`__setattr__`魔术方法。

3. Python如何实现内存管理？有没有可能出现内存泄露的问题？

   答：python有内存池机制，pymalloc机制，用于对内存的释放和管理。

   ```
   为什么要有内存池？
   当频繁创建大量消耗小的内存对象时，会频繁的调用new/malloc，导致大量的内存碎片。所以有了内存池
   内存池的概念就是预先在内存中申请一定数量的，大小相等的内存块留作备用，当有新的内存需求时，就先从内存池中分配内存给整个需求，不够了之后再申请新的内存
   ```

   pymalloc对于小的对象，pymalloc会再内存池申请空间。（小于256字节）

   如果大的对象，旧直接调用new/malloc来申请新的内存空间

   垃圾回收机制主要是靠gc模块的引用计数为主，又加了标记清除机制解决循环引用，分代回收提高效率

4. 阐述列表和集合的底层实现原理。

   答： 列表被实现为`长度可变的数组`   Python中的dict和set都是通过hash表和散列表来实现的 

5. 现有字典`d = {'a': 24, 'g': 52, 'i': 12, 'k': 33}`，如何按字典中的值对字典进行排序得到排序后的字典。

   答：

   ```Python
   sorted(d.items(),key=lambda x:x[1])
   ```

6. 实现将字符串`k1:v1|k2:v2|k3:v3`处理成字典`{'k1': 'v1', 'k2': 'v2', 'k3': 'v3'}`。

   答：

   ```Python
   {k:v for k, v in (
       item.split(':') for item in 'k1:v1|k2:v2|k3:v3'.split('|')
   )}
   ```

7. 写出生成从`m`到`n`公差为`k`的等差数列的生成器。

   答:

   ```Python
   (value for value in range(m, n + 1, k))
   ```

   或

   ```Python
   def generate(m, n, k):
       for value in range(m, n + 1, k):
           yield value
   ```

   或

   ```Python
   def generate(m, n, k):
       yield from range(m, n + 1, k)
   ```

8. 请写出你能想到的反转一个字符串的方式。

   答：

   ```Python
   ''.join(reversed('hello'))
   ```

   ```Python
   'hello'[::-1]
   ```

   ```Python
   def reverse(content):
       return ''.join(content[i] for i in range(len(content) - 1, -1, -1))
   reverse('hello')
   ```

   ```Python
   def reverse(content):
       return reverse(content[1:]) + content[0] if len(content) > 1 else content
   reverse('hello')
   ```

9. 不使用任何内置函数，将字符串`'123'`转换成整数`123`。

  答：

  ```Python
  nums = {'0': 0, '1': 1, '2': 2, '3': 3, '4': 4, '5': 5, '6': 6, '7': 7, '8': 8, '9': 9}
  total = 0 
  for ch in '123': 
      total *= 10 
      total += nums[ch]
  print(total)
  ```

11. 写一个返回bool值的函数，判断给定的非负整数是不是回文数。

    答：

    ```Python
    def huiwen(num:int):
        if str(num)[::-1] == str(num)
    ```

12. 用一行代码实现求任意非负整数的阶乘。

    答：

    ```Python
    from functools import reduce
    
    #(lambda num: reduce(int.__mul__, range(2, num + 1), 1))(5)
    num =5
    a = reduce(int.__mul__,range(2,num+1))
    print(a)
    ```

13. 写一个函数返回传入的整数列表中第二大的元素。

    答：

    ```Python
    
    ```

14. 删除列表中的重复元素并保留原有的顺序。

    答：

    ```Python
    L1 = [2,3,6,2,4,5]
    sorted(set(L1), key=L1.index)
    ```

15. 找出两个列表中的相同元素和不同元素。

    答：

    ```
    #方案一
    c=[x for x in L1 if x in L2]  #找相同  ···注意L1里面元素重复的问题
    d=[x for x in (L1+L2) if x not in  c]  #找不同
    ```

    ```
    #方案二
    list(set(L1)&set(L2))  #找相同
    list(set(L1)^set(L2))    #找不同
    ```

16. 列表中的某个元素出现次数占列表元素总数的半数以上，找出这个元素。

    答：

    ```Python
    def balance(L1):
        num = len(L1)
        balance_dict = {}
        index_list = []
        for i in range(num):
            
    ```

17. 实现对有序列表进行二分查找的算法。

    答：

    ```Python
    def binary_search(L1):
        index = len
    ```

18. 输入年月日，输出这一天是这一年的第几天。

    答：

    ```Python
    
    ```

19. 统计一个字符串中各个字符出现的次数。

    答：

    ```Python
    
    ```

20. 在Python中如何实现单例模式？

    答：

    ```Python
    #方式一，通过魔术方法__new__
    class Singleton:  
          def __new__(cls, *args, **kwargs):
              if not hasattr(cls,"_instance"):
              	cls.instance = object.__new__(cls)
              return cls._instance
    ```

    ```
    #方式二，通过字典的键唯一
    def singleton(cls):
    	_instance = {}  #创建一个字典，一会字典中键就是类，值就是对象
    	def _singleton(*args,**kwargs):
    		if cls not in _instance:
    			_instance[cls] = cls(*args,**kwargs)  #类创建对象，赋值给字典_instance，字典键cls唯一，所以一个类只有一个键
    		return _instance[cls]
    	return _singleton
    ```

    

21. 下面的代码会输出什么。

    ```Python
    class A:
        def __init__(self, value):
            self.__value = value
        @property
        def value(self):
            return self.__value
    
    a = A(1)
    a.__value = 2     #相当于动态添加属性
    print(a.__value)  # 2  
    print(a.value)	  # 1
    ```
    
22. 实现一个记录函数执行时间的装饰器。

    答：

    ```Python
    def count_time(func):
        @wraps(func)
        def warpper(*args,**kwargs)   #这里传的是func的参数
        	strat_time = time.time()
        	result = func(*args,**kwargs)
            end_time = time.time()
            print('执行时间',(end_time-start_time)
        	return resule
        return wrapper
    ```

23. 写一个遍历指定目录下指定后缀名的文件的函数。

    答：

    ```Python
    def getFileName(path):
        ''' 获取指定目录下的所有指定后缀的文件名 '''
        f_list = os.listdir(path)
        for i in f_list:
            # os.path.splitext():分离文件名与扩展名
            if os.path.splitext(i)[1] == '.log':
                print i
    ```

24. 有如下所示的字典，请将其转换为CSV格式。

    转换前：

    ```Python
    dict_corp = {
        'cn': {'id': 1, 'name': '土豆', 'desc': '土豆', 'price': {'gold': 20, 'kcoin': 20}},
        'en': {'id': 1, 'name': 'potato', 'desc': 'potato', 'price': {'gold': 20, 'kcoin': 20}},
        'kr': {'id': 1, 'name': '감자', 'desc':'감자', 'price': {'gold': 20, 'kcoin': 20}},
        'jp': {'id': 1, 'name': 'ジャガイモ', 'desc': 'ジャガイモ', 'price': {'gold': 20, 'kcoin': 20}},
    }
    ```

    转换后：

    ```CSV
    ,id,name,desc,gold,kcoin  
    cn,1,土豆,土豆,20,20
    en,1,potato,potato,20,20
    kr,1,감자,감자,20,20
    jp,1,ジャガイモ,ジャガイモ,20,20
    ```

25. 有如下所示的日志文件，请用Python程序或Linux命令打印出独立IP并统计数量。

    ```
    221.228.143.52 - - [23/May/2019:08:57:42 +0800] ""GET /about.html HTTP/1.1"" 206 719996
    218.79.251.215 - - [23/May/2019:08:57:44 +0800] ""GET /index.html HTTP/1.1"" 206 2350253
    220.178.150.3 - - [23/May/2019:08:57:45 +0800] ""GET /index.html HTTP/1.1"" 200 2350253
    218.79.251.215 - - [23/May/2019:08:57:52 +0800] ""GET /index.html HTTP/1.1"" 200 2350253
    ```
    
26. 请写出从HTML页面源代码中获取a标签href属性的正则表达式。

    答：

    ```Python
    
    ```

27. 正则表达式对象的`search`和`match`方法有什么区别？

    答：

28. 当多个线程竞争一个对象且该对象并非线程安全的时候应该怎么办？

    答：

29. 说一下死锁产生的条件以及如何避免死锁的发生。

    答：

30. 请阐述TCP的优缺点。

    答：TCP是可靠连接，面向连接，报文以字节流传输，传输效率低

31. HTTP请求的GET和POST有什么区别？

    答：

    ```
    GET和POST本质上都是TCP链接，并无差别，只是由于HTTP的规定和浏览器/服务器的限制，导致他们在应用过程中体现出一些不同。
    GET请求的参数拼接在url上，直接展示在地址栏上。
    POST内容放在body里面，一般用来提交私密性数据
    另外一些浏览器对于get请求的URL数据长度有限制
    GET能被缓存，POST不能缓存 
    GET只允许 ASCII 字符，所以url有中文等要用%编码。POST没有限制。也允许二进制数据。
    GET请求一般用在幂等，POST请求用在部幂等。 幂等的概念是指同一个请求方法执行多次和仅执行一次的效果完全相同，不会产生副作用
    ```

32. 说一些你知道的HTTP响应状态码。

    答：

    ``` 
    200 请求成功
    201 请求创建资源成功
    
    301 永久重定向
    302 临时重定向
    
    400 客户端请求错误
    403 服务端拒绝执行此请求
    404 服务端无法找到客户端请求资源
    405 Method Not Allowed
    
    500 Internal Server Error
    502 Bad Gateway  网关错误，一般是nginx启动，uwsgi未启动
    504 Gateway Timeout当服务器作为网关，不能及时得到响应时返回此错误代码
    505 Http Version Not Supported 服务器不支持请求使用的Http协议版本
    ```

33. 简单阐述HTTPS的工作原理。

    答：

34. 阐述Django项目中一个请求的生命周期。

    答：

    ```
    客户端发送请求
    DNS解析
    建立TCP连接
    传输报文
    nginx处理
    uWsgi处理
    当django接受到一个请求时，会初始化一个WSGIHandler，可以在项目下的wsgi.py文件进行跟踪查看
    中间件的process_request方法列表对request对象进行处理
    URLConf路由匹配,找到对应的视图函数
    调用中间件的 process_view 方法进行预处理
    views视图函数处理请求
    数据库操作
    调用中间件的 process_response 方法进行处理
    ```

35. Django项目中实现数据接口时如何解决跨域问题。

    答：

    ```
    一种是服务端处理
    服务端安装django-cors-header等，在响应头中设置允许跨域
    另外一种就是客户端处理
    使用代理
    ```

36. Django项目中如何对接Redis高速缓存服务。

    答：

37. 请说明Cookie和Session之间的关系。

    答：

38. 说一下索引的原理和作用。

    答：

39. 是否使用过Nginx实现负载均衡？用过哪些负载均衡算法？

    答：使用过

    ```
    轮询
    轮询加权
    ip_hash
    fair(第三方）
    fair算法可以根据页面大小和加载时间长短智能地进行负载均衡，也就是根据后端服务器的响应时间 来分配请求，响应时间短的优先分配。Nginx本身不支持fair，如果需要这种调度算法，则必须安装upstream_fair模块
    url_hash
    按访问的URL的哈希结果来分配请求，使每个URL定向到一台后端服务器，可以进一步提高后端缓存服务器的效率。Nginx本身不支持url_hash，如果需要这种调度算法，则必须安装Nginx的hash软件包
    ```

40. 一个保存整数（int）的数组，除了一个元素出现过1次外，其他元素都出现过两次，请找出这个元素。

    答：

41. Python中`is`运算符和`==`运算符有什么区别？

    答：`is`比较的是两个整数对象的id值是否相等，也就是比较两个引用是否代表了内存中同一个地址，是不是同一个对象

    ​		`==`比较的是两个整数对象的内容是否相等，使用`==`时其实是调用了对象的`__eq__()`方法
    
42. 两个班学生排成绩

    ```
    data = {'class1':{'s1':90,'s2':89,'s3':95},'class2':{'s1':90,'s2':89,'s3':89}}
    def sorted_dict(data):
        for i in data:
            s = list(data[i].values())
            s.sort(reverse=True)
            for j in data[i]:
                data[i][j] = s.index(data[i][j]) +1
    sorted_dict(data)
    print(data)
    ```

    

