程序编译与链接
Bulid 过程可以分解为 4 个步骤 :预处理 (Prepressing), 编译 (Compilation) 、汇编
(Assembly) 、链接 (Linking) 
以 c 语言为例 : 
1 预处理
预编译过程主要处理那些源文件中的以“ #”开始的预编译指令，主要处理规则有：

1. 将所有的“ #define ”删除，并展开所用的宏定义
2. 处理所有条件预编译指令，比如“ #if ”、“#ifdef ”、 “#elif ”、“#endif ”
3. 处理“ #include ”预编译指令，将被包含的文件插入到该编译指令的位置，
注：此过程是递归进行的
4. 删除所有注释
5. 添加行号和文件名标识，以便于编译时编译器产生调试用的行号信息以及用
于编译时产生编译错误或警告时可显示行号
6. 保留所有的 #pragma 编译器指令。
2 编译
编译过程就是把预处理完的文件进行一系列的词法分析、语法分析、语义分析及优
化后生成相应的汇编代码文件。这个过程是整个程序构建的核心部分。
3 汇编
汇编器是将汇编代码转化成机器可以执行的指令，每一条汇编语句几乎都是一条机
器指令。经过编译、链接、汇编输出的文件成为目标文件 (Object File) 
4 链接
链接的主要内容就是把各个模块之间相互引用的部分处理好，使各个模块可以正确
的拼接。
链接的主要过程包块 地址和空间的分配（ Address and Storage Allocation ）、符
号决议 (Symbol Resolution) 和重定位 (Relocation) 等步骤。
67
5 静态链接和动态链接
静态链接方法：静态链接的时候，载入代码就会把程序会用到的动态代码或动态代
码的地址确定下来
静态库的链接可以使用静态链接，动态链接库也可以使用这种方法链接导入库
动态链接方法：使用这种方式的程序并不在一开始就完成动态链接，而是直到真正
调用动态库代码时，载入程序才计算 (被调用的那部分 )动态代码的逻辑地址，然后
等到某个时候，程序又需要调用另外某块动态代码时，载入程序又去计算这部分代
码的逻辑地址，所以，这种方式使程序初始化时间较短，但运行期间的性能比不上
静态链接的程序
6 虚拟内存技术
虚拟存储器是值具有请求调入功能和置换功能 ,能从逻辑上对内存容量加以扩充的
一种存储系统 . 
7 分页和分段
分页: 用户程序的地址空间被划分成若干固定大小的区域，称为“页”，相应地，
内存空间分成若干个物理块，页和块的大小相等。可将用户程序的任一页放在内存
的任一块中，实现了离散分配。
分段: 将用户程序地址空间分成若干个大小不等的段，每段可以定义一组相对完整
的逻辑信息。存储分配时，以段为单位，段与段在内存中可以不相邻接，也实现了
离散分配。
68
分页与分段的主要区别
1. 页是信息的物理单位 ,分页是为了实现非连续分配 ,以便解决内存碎片问题 ,或
者说分页是由于系统管理的需要 .段是信息的逻辑单位 ,它含有一组意义相对完
整的信息 ,分段的目的是为了更好地实现共享 ,满足用户的需要 . 
2. 页的大小固定 ,由系统确定 ,将逻辑地址划分为页号和页内地址是由机器硬件
实现的 .而段的长度却不固定 ,决定于用户所编写的程序 ,通常由编译程序在对源
程序进行编译时根据信息的性质来划分 . 
3. 分页的作业地址空间是一维的 .分段的地址空间是二维的 . 
8 页面置换算法
1. 最佳置换算法 OPT:不可能实现
2. 先进先出 FIFO 
3. 最近最久未使用算法 LRU:最近一段时间里最久没有使用过的页面予以置换 . 
4. clock 算法
9 边沿触发和水平触发
边缘触发是指每当状态变化时发生一个 io 事件，条件触发是只要满足条件就发生
一个 io 事件